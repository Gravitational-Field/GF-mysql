本章主要讲解数据库安装和数据库基本介绍，考虑易用性及普及度，本课程采取mysql进行教学。

## 1.1 初识数据库

> 数据库（Database，DB）是可以一个高效访问的数据集合，由计算机加工而来。用来管理数据库的计算机系统应用称为数据库管理系统（Database Management System，DBMS）。

### 1.1.1 DBMS的种类

根据数据的保存格式进行分类： **#todo**

- 层次数据库（Hierarchical Database，HDB）
- 关系数据库（Relational Database，RDB）



### 1.1.2 RDBMS的常见系统结构

关系型数据库管理系统，最常见的结构为是客户端 / 服务器类型（C/S类型）。

<img src="https://cdn.jsdelivr.net/gh/lizhangjie316/img/2020/20201215211933.png" alt="image-20201215211933375" style="zoom:80%;" />



## 1.2 初识 SQL

![image-20201215212103067](https://cdn.jsdelivr.net/gh/lizhangjie316/img/2020/20201215212103.png)

在数据库中，行称为**记录**，它相当于一条记录，列称为**字段**，它代表了表中存储的数据项目。行和列交汇的地方称为单元格，一个单元格中只能输入一条记录。

SQL语言分为标准SQL和特定SQL。

- 标准SQL

  ​    国际标准化组织（ISO）为 SQL 制定了相应的标准，以此为基准的SQL 称为标准 SQL。

- 特定SQL

  ​    通常不同的RDBMS会编写特定的SQL语句，但一般对标准SQL都进行了支持。

### 1.2.1 DDL

> DDL（Data Definition Language，数据定义语言）
>
> 用来创建、删除更改数据库的表结构。

包括以下几种指令：

- CREATE ： 创建数据库和表等对象
- DROP ： 删除数据库和表等对象
- ALTER ： 修改数据库和表等对象的结构

### 1.2.2 DML
> DML（Data Manipulation Language，数据操纵语言）
>
> 用来进行表中记录的增删改查操作。

包括以下几种指令：

- INSERT ：向表中插入新数据
- DELETE ：删除表中的数据
- UPDATE ：更新表中的数据
- SELECT ：查询表中的数据


### 1.2.3 DCL

> DCL（Data Control Language，数据控制语言）
>
> 1. 用来进行数据库的事务管理；
> 2. 设定RDBMS中不同用户的访问权限。

包含以下几种指令：

- COMMIT ： 确认对数据库中的数据进行的变更
- ROLLBACK ： 取消对数据库中的数据进行的变更
- GRANT ： 赋予用户操作权限
- REVOKE ： 取消用户的操作权限



## 1.3 Sql语句书写

### 1.3.1 SQL的基本书写规则

* SQL语句要以分号（ ; ）结尾
* SQL 不区分关键字的大小写，但是插入到表中的数据是区分大小写的
* win 系统默认不区分表名及字段名的大小写
* linux / mac 默认严格区分表名及字段名的大小写
     * 本教程已统一调整表名及字段名的为小写，以方便初学者学习使用。··
* 常数的书写方式是固定的    'abc', 1234, '26 Jan 2010', '10/01/26', '2010-01-26'......

* 单词需要用半角空格或者换行来分隔

​        **PS：SQL 语句的单词之间需使用半角空格或换行符来进行分隔，不能使用全角空格作为单词的分隔符，否则会发生错误，出现无法预期的结果。**









# 练习题

## 1.1 创建一个表

编写一条 CREATE TABLE 语句，用来创建一个包含表 1-A 中所列各项的表 Addressbook （地址簿），并为 regist_no （注册编号）列设置主键约束

表1-A　表 Addressbook （地址簿）中的列

![图片](https://cdn.jsdelivr.net/gh/lizhangjie316/img/2020/20201215221119.png)

```
create table Addressbook(
	regist_no Integer,
	name varchar(128) not null,
	address varchar(256) not null,
	tel_no char(10),
	mail_address char(20)
);
```






## 1.2 表中添加一个字段

假设在创建练习1.1中的 Addressbook 表时忘记添加如下一列 postal_code （邮政编码）了，请把此列添加到 Addressbook 表中。

列名        ： postal_code

数据类型 ：定长字符串类型（长度为 8）

约束        ：不能为 NULL

```
alter table addressbook add column postal_code char(8) not null;
```



## 1.3 编写 SQL 语句来删除 Addressbook 表。

```
drop table addressbook
```



## 1.4 编写 SQL 语句来恢复删除掉的 Addressbook 表。

```
-- 只能重新创建，无法恢复
create table Addressbook(
	regist_no Integer,
	name varchar(128) not null,
	address varchar(256) not null,
	tel_no char(10),
	mail_address char(20)
);
```







### 《附录1 - SQL 语法规范》

```sql
-- 样例一
(SELECT flora.species_name
        ,AVG(flora.height) AS average_height
        ,AVG(flora.diameter) AS average_diameter
   FROM flora
  WHERE flora.species_name = 'Banksia'
     OR flora.species_name = 'Sheoak'
     OR flora.species_name = 'Wattle'
  GROUP BY flora.species_name, flora.observation_date)
  UNION ALL
(SELECT botanic.species_name
        ,AVG(b.height) AS average_height
        ,AVG(b.diameter) AS average_diameter
   FROM botanic_garden_flora AS botanic
  WHERE botanic.species_name = 'Banksia'
     OR botanic.species_name = 'Sheoak'
     OR botanic.species_name = 'Wattle'
  GROUP BY botanic.species_name, botanic.observation_date);
-- 样例二
SELECT botanic.species_name
       ,AVG(b.height) AS average_height
       ,AVG(b.diameter) AS average_diameter
  FROM botanic_garden_flora AS botanic
 WHERE botanic.species_name IN (SELECT species_name
                                  FROM flora 
                                 WHERE height >= 3) 
 GROUP BY botanic.species_name, botanic.observation_da;
 
-- 样例三
SELECT SP.shop_id, SP.shop_name, SP.product_id, P.product_name, P.product_type, P.purchase_price
  FROM shopproduct  AS SP 
 INNER JOIN -- product
   (SELECT product_name, product_type, purchase_price
      FROM Product ) AS P 
    ON SP.product_id=P.product_id
 WHERE P.product_type='衣服';
```

1. MySQL本身不区分大小写，但强烈要求关键字大写，表名、列名用小写；
2. 创建表时，使用统一的、描述性强的字段命名规则保证字段名是独一无二且不是保留字的，不要使用连续的下划线，不用下划线结尾；最好以字母开头
3. 关键字右对齐，且不同层级的用空格或缩进控制，使其区分开，见样例二；
4. 列名少的时候写在一行里无伤大雅；多的时候以及涉及到CASE WHEN 或者聚合计算的时候，建议分行写；个人习惯是逗号在列名前面，方便之后删除某些列，放列名后亦可；
5. 表别名和列别名尽量用有具体含义的词组，不要用a b c，不然以后review的时候会非常痛苦；
6. 运算符前后都加一个空格；
7. 当用到多个表时，请在所有列名前写上引用的表别名，不要嫌麻烦；
8. 每条命令用分号结尾；
9. 养成随手写注释的习惯，注释方法：

```sql
单行注释 # 注释文字
单行注释 -- 注释文字
多行注释：/* 注释文字 */
```

### 参考资料

1. SQL编程风格 [https://zhuanlan.zhihu.com/p/27466166 3](https://zhuanlan.zhihu.com/p/27466166)
2. SQL Style Guide https://www.sqlstyle.guide/



